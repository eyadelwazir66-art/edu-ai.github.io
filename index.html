<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EDU EMPIRE 2026 | Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ø§Ù…Ù„</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://meet.jit.si/external_api.js"></script>

    <style>
        :root { --p: #6366f1; --s: #a855f7; --bg: #0b0f1a; --glass: rgba(255, 255, 255, 0.05); }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, sans-serif; }
        body { background: var(--bg); color: white; min-height: 100vh; display: flex; overflow: hidden; }
        
        .hidden { display: none !important; }
        .btn { cursor: pointer; border: none; border-radius: 10px; padding: 12px 24px; color: white; font-weight: bold; background: linear-gradient(45deg, var(--p), var(--s)); transition: 0.3s; display: inline-flex; align-items: center; gap: 8px; text-decoration: none; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4); }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        aside { width: 260px; background: rgba(0,0,0,0.95); padding: 25px; display: flex; flex-direction: column; border-left: 1px solid rgba(255,255,255,0.1); z-index: 1000; transition: 0.3s; }
        .nav-link { padding: 15px; cursor: pointer; border-radius: 12px; margin-bottom: 8px; color: #94a3b8; display: flex; align-items: center; gap: 12px; transition: 0.2s; }
        .nav-link:hover, .nav-link.active { background: var(--p); color: white; }

        /* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        main { flex: 1; padding: 30px; overflow-y: auto; background: radial-gradient(circle at top right, #1e1b4b, #0b0f1a); }
        .card { background: var(--glass); backdrop-filter: blur(20px); padding: 25px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.1); margin-bottom: 25px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        #auth-screen { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; justify-content: center; align-items: center; }
        .auth-box { width: 400px; text-align: center; border: 1px solid var(--p); padding: 40px; }
        input, select, textarea { width: 100%; padding: 14px; margin: 10px 0; border-radius: 12px; border: 1px solid #334155; background: rgba(0,0,0,0.6); color: white; outline: none; font-size: 16px; }

        /* Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± */
        .meet-area { height: 550px; border-radius: 20px; border: 2px solid var(--p); overflow: hidden; margin-top: 20px; background: #000; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; text-align: right; }
        th, td { padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); }

        @media (max-width: 768px) {
            body { flex-direction: column; }
            aside { width: 100%; height: auto; flex-direction: row; padding: 10px; position: fixed; bottom: 0; border-left: none; border-top: 1px solid #334155; overflow-x: auto; background: #000; }
            .nav-link { padding: 10px; font-size: 12px; flex-direction: column; gap: 5px; min-width: 80px; }
            main { padding: 15px; padding-bottom: 100px; }
        }
    </style>
</head>
<body>

    <div id="auth-screen">
        <div class="card auth-box">
            <h1 style="color:var(--p); font-size: 2.5rem; margin-bottom: 10px;">EDU EMPIRE</h1>
            <p style="color: #94a3b8; margin-bottom: 30px;">Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø°ÙƒÙŠ 2026</p>
            
            <div id="signup-fields" class="hidden">
                <input type="text" id="reg-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„">
            </div>
            <input type="text" id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ / Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„">
            <input type="password" id="pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            
            <button class="btn" style="width:100%; justify-content: center; margin-top: 10px;" onclick="login()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù†</button>
            <p onclick="toggleReg()" style="margin-top:20px; cursor:pointer; color:var(--s); font-weight: bold;">Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†</p>
        </div>
    </div>

    <div id="app" class="hidden" style="display:flex; width:100%;">
        <aside>
            <div style="text-align:center; margin-bottom:30px;">
                <img src="" id="user-avatar" style="width:70px; height:70px; border-radius:50%; border:3px solid var(--p); object-fit: cover;">
                <p id="user-side-name" style="font-weight:bold; margin-top:15px; font-size: 1.1rem;"></p>
            </div>
            <div class="nav-link active" onclick="switchPage('home', this)"><i class="fa fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
            <div id="adm-nav" class="nav-link hidden" onclick="switchPage('admin', this)"><i class="fa fa-user-shield"></i> Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³ØªØ±</div>
            <div class="nav-link" onclick="switchPage('live', this)"><i class="fa fa-video"></i> Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</div>
            <div class="nav-link" onclick="switchPage('quiz', this)"><i class="fa fa-tasks"></i> Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª</div>
            <div class="nav-link" onclick="switchPage('files', this)"><i class="fa fa-book"></i> Ø§Ù„Ù…Ù„Ø§Ø²Ù…</div>
            <div class="nav-link" onclick="switchPage('qa', this)"><i class="fa fa-comments"></i> Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</div>
            <button class="btn" style="margin-top:auto; background:#f43f5e; justify-content: center;" onclick="location.reload()"><i class="fa fa-sign-out-alt"></i> Ø®Ø±ÙˆØ¬</button>
        </aside>

        <main>
            <div id="page-home" class="content-page">
                <div class="grid">
                    <div class="card" style="text-align: center;">
                        <i class="fa fa-star" style="color: gold; font-size: 2rem;"></i>
                        <h3 style="margin-top:10px;">Ù†Ù‚Ø§Ø·ÙŠ</h3>
                        <h2 id="u-points" style="font-size: 3rem; color: var(--p);">0</h2>
                    </div>
                    <div class="card" style="text-align: center;">
                        <i class="fa fa-calendar-alt" style="color: var(--s); font-size: 2rem;"></i>
                        <h3 style="margin-top:10px;">Ù…ÙˆØ¹Ø¯ Ø­ØµØªÙŠ</h3>
                        <p id="countdown" style="font-size: 1.2rem; font-weight: bold; margin-top:10px;">Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø¨Ø¹Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ¹Ø¯</p>
                    </div>
                </div>
                <div class="card">
                    <h3>ğŸ“¢ Ù„ÙˆØ­Ø© Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ±</h3>
                    <div id="ann-list" style="margin-top:20px;"></div>
                </div>
            </div>

            <div id="page-admin" class="content-page hidden">
                <h2>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØµØ© (Ù…Ø³ØªØ± Ø¥ÙŠØ§Ø¯)</h2>
                <div class="grid" style="margin-top:20px;">
                    <div class="card">
                        <h4>Ù†Ø´Ø± Ø¥Ø¹Ù„Ø§Ù† Ø£Ùˆ Ù…Ù„Ø²Ù…Ø©</h4>
                        <input id="adm-ann" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ø²Ù…Ø©">
                        <input id="adm-url" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù„Ø²Ù…Ø© (Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºØ§Ù‹ Ù„Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙÙ‚Ø·)">
                        <button class="btn" onclick="postNew()">Ù†Ø´Ø± Ø§Ù„Ø¢Ù†</button>
                    </div>
                    <div class="card">
                        <h4>Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ Ø§Ù…ØªØ­Ø§Ù†</h4>
                        <input id="adm-q" placeholder="Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„">
                        <input id="adm-a" placeholder="Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©">
                        <button class="btn" onclick="postQuiz()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</button>
                    </div>
                </div>
                <div class="card" style="overflow-x: auto;">
                    <h3>Ø§Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</h3>
                    <table>
                        <thead>
                            <tr style="color:var(--p); border-bottom: 2px solid var(--p);">
                                <th>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                                <th>Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù…Ø®ØªØ§Ø±</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø¥Ø¬Ø±Ø§Ø¡</th>
                            </tr>
                        </thead>
                        <tbody id="admin-table"></tbody>
                    </table>
                </div>
            </div>

            <div id="page-live" class="content-page hidden">
                <div id="live-lock" class="card" style="text-align:center; padding:60px;">
                    <i class="fa fa-shield-halved" style="font-size:80px; color:#f43f5e; margin-bottom: 20px;"></i>
                    <h2>Ø­Ø³Ø§Ø¨Ùƒ ØºÙŠØ± Ù…ÙØ¹Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹</h2>
                    <p style="color:#94a3b8; margin: 20px 0;">Ø¨Ø±Ø¬Ø§Ø¡ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø³ØªØ± Ù„ØªÙØ¹ÙŠÙ„ Ø§Ø´ØªØ±Ø§ÙƒÙƒ ÙˆØ§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø­ØµØ©</p>
                    <button class="btn" onclick="toWA()" style="background:#25d366;"><i class="fab fa-whatsapp"></i> ØªÙˆØ§ØµÙ„ Ù„Ù„ØªÙØ¹ÙŠÙ„</button>
                </div>

                <div id="time-picker-screen" class="card hidden" style="text-align:center; padding:50px;">
                    <i class="fa fa-clock-rotate-left" style="font-size:60px; color:var(--p); margin-bottom: 20px;"></i>
                    <h2>Ù…Ø¨Ø±ÙˆÙƒØŒ ØªÙ… ØªÙØ¹ÙŠÙ„ Ø­Ø³Ø§Ø¨Ùƒ!</h2>
                    <p style="margin-bottom: 25px; color:#94a3b8;">Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø®ØªØ± Ù…ÙˆØ¹Ø¯ Ø­ØµØªÙƒ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ Ø§Ù„Ø«Ø§Ø¨Øª Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©:</p>
                    <div style="max-width: 400px; margin: 0 auto;">
                        <select id="select-day">
                            <option value="" disabled selected>Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…</option>
                            <option>Ø§Ù„Ø³Ø¨Øª</option><option>Ø§Ù„Ø£Ø­Ø¯</option><option>Ø§Ù„Ø§Ø«Ù†ÙŠÙ†</option>
                            <option>Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option><option>Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option><option>Ø§Ù„Ø®Ù…ÙŠØ³</option><option>Ø§Ù„Ø¬Ù…Ø¹Ø©</option>
                        </select>
                        <input type="time" id="select-time">
                        <button class="btn" style="width:100%; justify-content: center; margin-top: 20px;" onclick="confirmStudentTime()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…ÙˆØ¹Ø¯ ÙˆØ¯Ø®ÙˆÙ„ Ø§Ù„Ø­ØµØ©</button>
                    </div>
                </div>

                <div id="live-area" class="hidden">
                    <div class="card" style="margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
                        <h3>Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ø§Ù„Ø¢Ù† ğŸ”´</h3>
                        <p id="student-confirmed-time" style="color: var(--s); font-weight: bold;"></p>
                    </div>
                    <div id="jitsi-box" class="meet-area"></div>
                    <button id="j-btn" class="btn" style="margin-top:20px; width: 100%; justify-content: center;" onclick="startJitsi()">Ø¨Ø¯Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø­ØµØ© ğŸš€</button>
                </div>
            </div>

            <div id="page-quiz" class="content-page hidden">
                <h2>Ù…Ø±ÙƒØ² Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</h2>
                <div id="q-list" class="grid" style="margin-top:20px;"></div>
            </div>

            <div id="page-files" class="content-page hidden">
                <h2>Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…Ù„Ø§Ø²Ù… ÙˆØ§Ù„ÙƒØªØ¨</h2>
                <div id="f-list" class="grid" style="margin-top:20px;"></div>
            </div>

            <div id="page-qa" class="content-page hidden">
                <h2>Ø§Ø³Ø£Ù„ Ø§Ù„Ù…Ø³ØªØ±</h2>
                <div class="card">
                    <textarea id="qa-msg" rows="4" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§ Ø¨Ø§Ù„ØªÙØµÙŠÙ„ ÙˆØ³ÙŠØªÙ… Ø§Ù„Ø±Ø¯ Ø¹Ù„ÙŠÙƒ ÙÙŠ Ø£Ù‚Ø±Ø¨ ÙˆÙ‚Øª..."></textarea>
                    <button class="btn" onclick="sendQA()" style="margin-top:10px;">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„</button>
                </div>
                <div id="qa-list"></div>
            </div>
        </main>
    </div>

    <script>
        // Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©
        let db = JSON.parse(localStorage.getItem('edu_empire_final_db') || '{"users":[], "anns":[], "quiz":[], "files":[], "qa":[]}');
        let currentUser = null;
        let isRegistering = false;

        function saveDB() { localStorage.setItem('edu_empire_final_db', JSON.stringify(db)); }

        function toggleReg() {
            isRegistering = !isRegistering;
            document.getElementById('signup-fields').classList.toggle('hidden');
            document.querySelector('#auth-screen p').innerText = isRegistering ? "Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„" : "Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†";
        }

        function login() {
            const email = document.getElementById('email').value.trim();
            const pass = document.getElementById('pass').value.trim();

            if (isRegistering) {
                const name = document.getElementById('reg-name').value.trim();
                if (!name || !email || !pass) return alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ù…Ù„Ø£ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
                
                // Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
                const newUser = {
                    name: name,
                    email: email,
                    pass: pass,
                    active: false,
                    points: 0,
                    myDay: '',
                    myTime: '',
                    role: 'student'
                };
                db.users.push(newUser);
                saveDB();
                alert("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­! Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ø§Ù„Ø¢Ù†");
                toggleReg();
            } else {
                // Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ±
                if (email === "01019339230" && pass === "dodody123") {
                    currentUser = { name: "Ù…Ø³ØªØ± Ø¥ÙŠØ§Ø¯", role: "admin" };
                    document.getElementById('adm-nav').classList.remove('hidden');
                    startApp();
                } else {
                    // Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨
                    const found = db.users.find(u => u.email === email && u.pass === pass);
                    if (found) {
                        currentUser = found;
                        startApp();
                    } else {
                        alert("Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©");
                    }
                }
            }
        }

        function startApp() {
            document.getElementById('auth-screen').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            document.getElementById('user-side-name').innerText = currentUser.name;
            document.getElementById('user-avatar').src = `https://ui-avatars.com/api/?name=${currentUser.name}&background=6366f1&color=fff`;
            updateUI();
        }

        function switchPage(pageId, element) {
            document.querySelectorAll('.content-page').forEach(p => p.classList.add('hidden'));
            document.getElementById('page-' + pageId).classList.remove('hidden');
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            element.classList.add('active');

            if (pageId === 'live') handleLiveAccess();
        }

        function handleLiveAccess() {
            if (currentUser.role === 'admin') {
                document.getElementById('live-lock').classList.add('hidden');
                document.getElementById('time-picker-screen').classList.add('hidden');
                document.getElementById('live-area').classList.remove('hidden');
                return;
            }

            if (currentUser.active) {
                document.getElementById('live-lock').classList.add('hidden');
                if (!currentUser.myDay) {
                    document.getElementById('time-picker-screen').classList.remove('hidden');
                    document.getElementById('live-area').classList.add('hidden');
                } else {
                    document.getElementById('time-picker-screen').classList.add('hidden');
                    document.getElementById('live-area').classList.remove('hidden');
                    document.getElementById('student-confirmed-time').innerText = `Ù…ÙˆØ¹Ø¯Ùƒ: ${currentUser.myDay} - ${currentUser.myTime}`;
                }
            } else {
                document.getElementById('live-lock').classList.remove('hidden');
            }
        }

        function confirmStudentTime() {
            const day = document.getElementById('select-day').value;
            const time = document.getElementById('select-time').value;

            if (!day || !time) return alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„Ø³Ø§Ø¹Ø©");

            currentUser.myDay = day;
            currentUser.myTime = time;
            
            // ØªØ­Ø¯ÙŠØ« ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            const idx = db.users.findIndex(u => u.email === currentUser.email);
            if (idx !== -1) db.users[idx] = currentUser;
            
            saveDB();
            alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø¨Ù†Ø¬Ø§Ø­!");
            handleLiveAccess();
            updateUI();
        }

        function updateUI() {
            // Ù†Ù‚Ø§Ø· Ø§Ù„Ø·Ø§Ù„Ø¨
            if (currentUser.role !== 'admin') {
                document.getElementById('u-points').innerText = currentUser.points;
                document.getElementById('countdown').innerText = currentUser.myDay ? `${currentUser.myDay} - ${currentUser.myTime}` : "Ø­Ø¯Ø¯ Ù…ÙˆØ¹Ø¯Ùƒ Ù…Ù† ØµÙØ­Ø© Ø§Ù„Ø¨Ø«";
            }

            // Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
            document.getElementById('ann-list').innerHTML = db.anns.slice().reverse().map(a => `
                <div class="card" style="background: rgba(99, 102, 241, 0.1); border-right: 5px solid var(--p);">
                    <p>${a}</p>
                </div>
            `).join('') || "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©";

            // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
            let rows = "";
            db.users.forEach((u, i) => {
                rows += `
                    <tr>
                        <td>${u.name}</td>
                        <td>${u.myDay ? u.myDay + ' (' + u.myTime + ')' : '<span style="color:gray">Ù„Ù… ÙŠØ­Ø¯Ø¯</span>'}</td>
                        <td style="color:${u.active ? '#10b981' : '#f43f5e'}; font-weight:bold;">${u.active ? 'Ù†Ø´Ø·' : 'Ù…ØºÙ„Ù‚'}</td>
                        <td><button class="btn" style="padding:5px 10px; font-size:12px;" onclick="toggleUser(${i})">ØªÙØ¹ÙŠÙ„/Ù‚ÙÙ„</button></td>
                    </tr>
                `;
            });
            document.getElementById('admin-table').innerHTML = rows;

            // Ø§Ù„Ù…Ù„Ø§Ø²Ù…
            document.getElementById('f-list').innerHTML = db.files.map(f => `
                <div class="card" style="text-align:center;">
                    <i class="fa fa-file-pdf" style="font-size:3rem; color:#f43f5e;"></i>
                    <h4 style="margin:15px 0;">${f.n}</h4>
                    <a href="${f.u}" target="_blank" class="btn" style="width:100%; justify-content:center;">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¢Ù†</a>
                </div>
            `).join('');

            // Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª
            document.getElementById('q-list').innerHTML = db.quiz.map((q, i) => `
                <div class="card">
                    <h4>${q.q}</h4>
                    <button class="btn" style="margin-top:15px; width:100%; justify-content:center;" onclick="solveQuiz(${i})">Ø¨Ø¯Ø¡ Ø§Ù„Ø­Ù„</button>
                </div>
            `).join('');

            // Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
            document.getElementById('qa-list').innerHTML = db.qa.slice().reverse().map(m => `
                <div class="card">
                    <b style="color:var(--p)">${m.u}:</b>
                    <p style="margin-top:5px;">${m.t}</p>
                </div>
            `).join('');
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø£Ø¯Ù…Ù†
        function postNew() {
            const title = document.getElementById('adm-ann').value;
            const url = document.getElementById('adm-url').value;
            if (!title) return alert("Ø§Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù†Ø§Ù‹");
            if (url) db.files.push({ n: title, u: url });
            else db.anns.push(title);
            saveDB(); updateUI();
            alert("ØªÙ… Ø§Ù„Ù†Ø´Ø±!");
        }

        function postQuiz() {
            const q = document.getElementById('adm-q').value;
            const a = document.getElementById('adm-a').value;
            if (!q || !a) return alert("Ø§Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„ ÙˆØ§Ù„Ø­Ù„");
            db.quiz.push({ q, a });
            saveDB(); updateUI();
            alert("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ø¤Ø§Ù„!");
        }

        function toggleUser(i) {
            db.users[i].active = !db.users[i].active;
            saveDB(); updateUI();
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø·Ø§Ù„Ø¨
        function solveQuiz(i) {
            const answer = prompt(db.quiz[i].q);
            if (answer === db.quiz[i].a) {
                alert("Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! Ø­ØµÙ„Øª Ø¹Ù„Ù‰ 10 Ù†Ù‚Ø§Ø· â­");
                if (currentUser.role !== 'admin') {
                    currentUser.points += 10;
                    const idx = db.users.findIndex(u => u.email === currentUser.email);
                    db.users[idx].points = currentUser.points;
                    saveDB(); updateUI();
                }
            } else {
                alert("Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.");
            }
        }

        function sendQA() {
            const msg = document.getElementById('qa-msg').value;
            if (!msg) return;
            db.qa.push({ u: currentUser.name, t: msg });
            saveDB(); updateUI();
            document.getElementById('qa-msg').value = "";
        }

        function toWA() {
            window.open(`https://wa.me/201019339230?text=ÙŠØ§ Ù…Ø³ØªØ± Ø£Ù†Ø§ Ø³Ø¬Ù„Øª ÙÙŠ Ø§Ù„Ù…Ù†ØµØ© ÙˆÙ…Ø­ØªØ§Ø¬ Ø£ÙØ¹Ù„ Ø§Ù„Ø­Ø³Ø§Ø¨: ${currentUser.email}`, '_blank');
        }

        function startJitsi() {
            const roomName = "EDU_EMPIRE_2026_" + (currentUser.role === 'admin' ? "MASTER" : currentUser.email.replace(/[^a-zA-Z]/g, ""));
            const options = {
                roomName: roomName,
                width: '100%',
                height: '100%',
                parentNode: document.querySelector('#jitsi-box'),
                userInfo: { displayName: currentUser.name }
            };
            new JitsiMeetExternalAPI("meet.jit.si", options);
            document.getElementById('j-btn').style.display = 'none';
        }
    </script>
</body>
</html>